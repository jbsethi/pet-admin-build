(this["webpackJsonp@coreui/coreui-free-react-admin-template"]=this["webpackJsonp@coreui/coreui-free-react-admin-template"]||[]).push([[19],{723:function(e,t,c){"use strict";function a(e,t,c,a,i,r,n){try{var s=e[r](n),o=s.value}catch(l){return void c(l)}s.done?t(o):Promise.resolve(o).then(a,i)}function i(e){return function(){var t=this,c=arguments;return new Promise((function(i,r){var n=e.apply(t,c);function s(e){a(n,i,r,s,o,"next",e)}function o(e){a(n,i,r,s,o,"throw",e)}s(void 0)}))}}c.d(t,"a",(function(){return i}))},732:function(e,t,c){"use strict";var a=c(725),i=c.n(a),r=c(723),n=c(195),s=c(63),o=c(82),l=c(1),d=c.n(l),u=c(726),j=c(89),m=c(720),p=c(194),h=c(719),b=c(22);t.a=function(e){var t,c=e.show,a=e.setShow,l=e.dispatch,O=d.a.useContext(p.a).addToast,x=d.a.useState({categoryId:null,itemId:null,packageId:null,quantity:1,discount:0}),v=Object(o.a)(x,2),f=v[0],g=v[1],y=d.a.useState([]),I=Object(o.a)(y,2),w=I[0],F=I[1],k=d.a.useState([]),C=Object(o.a)(k,2),N=C[0],V=C[1],R=d.a.useState([]),S=Object(o.a)(R,2),D=S[0],A=S[1],E=Object(m.a)({url:h.a+"/services",method:"POST"},{manual:!0}),T=Object(o.a)(E,2)[1],G=function(e){var t;e.isSelect?(["packageId","itemId"].includes(e.valueFor)&&(t="itemId"===e.valueFor?"packageId":"itemId"),g((function(c){var a;return Object(s.a)(Object(s.a)({},c),{},(a={},Object(n.a)(a,t,null),Object(n.a)(a,e.valueFor,e.option),a))}))):g((function(t){return Object(s.a)(Object(s.a)({},t),{},Object(n.a)({},e.target.name,e.target.value))}))},P=d.a.useCallback(Object(r.a)(i.a.mark((function e(){var t,c,a,r,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,T({url:h.a+"/services",method:"GET"});case 3:c=e.sent,a=((null===c||void 0===c||null===(t=c.data)||void 0===t?void 0:t.rows)||[]).map((function(e){return{label:e.displayName,value:e.id}})),F(a),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),e.t0.response&&O({message:(null===e.t0||void 0===e.t0||null===(r=e.t0.response)||void 0===r||null===(n=r.data)||void 0===n?void 0:n.message)||"Error Try again later !"});case 11:case"end":return e.stop()}}),e,null,[[0,8]])}))),[T]),q=d.a.useCallback(Object(r.a)(i.a.mark((function e(){var t,c,a,r,n,o,l,d;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,g((function(e){return Object(s.a)(Object(s.a)({},e),{},{itemId:null,packageId:null})})),e.next=4,T({url:h.a+"/packages/records/active",method:"GET",params:{serviceId:(null===(t=f.categoryId)||void 0===t?void 0:t.value)||null}});case 4:return a=e.sent,r=((null===a||void 0===a?void 0:a.data)||[]).map((function(e){return{label:e.name,value:e.id,price:e.price}})),A(r),e.next=9,T({url:h.a+"/items/records/active",method:"GET",params:{serviceId:(null===(c=f.categoryId)||void 0===c?void 0:c.value)||null}});case 9:n=e.sent,o=((null===n||void 0===n?void 0:n.data)||[]).map((function(e){return{label:e.name,value:e.id,price:e.price}})),V(o),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),O({message:(null===e.t0||void 0===e.t0||null===(l=e.t0.response)||void 0===l||null===(d=l.data)||void 0===d?void 0:d.message)||"Error occured. Please try again ."});case 17:case"end":return e.stop()}}),e,null,[[0,14]])}))),[T,null===f||void 0===f||null===(t=f.categoryId)||void 0===t?void 0:t.value]);return d.a.useEffect((function(){c&&P()}),[c,P]),d.a.useEffect((function(){c&&f.categoryId&&(V([]),A([]),q())}),[c,q,f.categoryId]),Object(b.jsxs)(j.K,{show:c,onClose:function(){return a(!1)},children:[Object(b.jsx)(j.N,{children:"Add Item"}),Object(b.jsxs)(j.L,{children:[Object(b.jsxs)(j.x,{row:!0,children:[Object(b.jsx)(j.l,{children:Object(b.jsx)(j.G,{className:"pt-2",htmlFor:"text-category",children:"Category"})}),Object(b.jsx)(j.l,{xs:"12",children:Object(b.jsx)(u.a,{value:f.categoryId,name:"categoryId",options:w,onChange:function(e){return G({isSelect:!0,valueFor:"categoryId",option:e})}})})]}),Object(b.jsxs)(j.x,{row:!0,children:[Object(b.jsx)(j.l,{children:Object(b.jsx)(j.G,{className:"pt-2",htmlFor:"text-package",children:"Package"})}),Object(b.jsx)(j.l,{xs:"12",children:Object(b.jsx)(u.a,{value:f.packageId,name:"packageItem",options:D,onChange:function(e){return G({isSelect:!0,valueFor:"packageId",option:e})}})})]}),Object(b.jsxs)(j.x,{row:!0,children:[Object(b.jsx)(j.l,{children:Object(b.jsx)(j.G,{className:"pt-2",htmlFor:"text-package-item",children:"Item"})}),Object(b.jsx)(j.l,{xs:"12",children:Object(b.jsx)(u.a,{value:f.itemId,name:"packageItem",options:N,onChange:function(e){return G({isSelect:!0,valueFor:"itemId",option:e})}})})]}),Object(b.jsxs)(j.x,{row:!0,children:[Object(b.jsx)(j.l,{children:Object(b.jsx)(j.G,{className:"pt-2",htmlFor:"text-qty",children:"Quantity"})}),Object(b.jsx)(j.l,{xs:"12",children:Object(b.jsx)(j.B,{value:f.quantity,id:"text-qty",name:"quantity",placeholder:"Enter Quantity",type:"number",onChange:G})})]}),Object(b.jsxs)(j.x,{row:!0,children:[Object(b.jsx)(j.l,{children:Object(b.jsx)(j.G,{className:"pt-2",htmlFor:"text-qty",children:"Discount ( % )"})}),Object(b.jsx)(j.l,{xs:"12",children:Object(b.jsx)(j.B,{value:f.discount,id:"text-qty",name:"discount",placeholder:"Enter discount",type:"number",onChange:G})})]})]}),Object(b.jsxs)(j.M,{children:[Object(b.jsx)(j.f,{color:"danger",onClick:function(){return a(!1)},children:"Cancel"}),Object(b.jsx)(j.f,{color:"primary",onClick:function(){f.categoryId&&(f.itemId||f.packageId)?f.quantity<=0?O({message:"Quantity must not be 0 !"}):(l({type:"addItemInReceipt",payload:f}),g({categoryId:null,itemId:null,packageId:null,quantity:1,discount:0}),a(!1)):O({message:"Please select item first !"})},children:"Submit"})]})]})}},853:function(e,t,c){"use strict";c.r(t);var a=c(63),i=c(725),r=c.n(i),n=c(723),s=c(82),o=c(1),l=c.n(o),d=c(89),u=c(29),j=c(726),m=c(720),p=c(22),h=function(e){var t=e.isVisitorRecordAdded,c=e.visitorRecord,a=e.dispatch;return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsxs)(d.x,{children:[Object(p.jsx)(d.G,{htmlFor:"contact",children:"Phone No"}),Object(p.jsx)(d.B,{disabled:t,value:c.contact,name:"contact",onChange:function(e){return a({type:"handleChangeVisitorRecord",payload:e})},id:"contact",placeholder:"Enter Phone number"})]}),Object(p.jsxs)(d.x,{children:[Object(p.jsx)(d.G,{htmlFor:"name",children:"Visitors Name"}),Object(p.jsx)(d.B,{disabled:t,value:c.name,name:"name",onChange:function(e){return a({type:"handleChangeVisitorRecord",payload:e})},id:"name",placeholder:"Enter Visitor's name"})]}),Object(p.jsxs)(d.x,{children:[Object(p.jsx)(d.G,{htmlFor:"email",children:"Email"}),Object(p.jsx)(d.B,{disabled:t,value:c.email,name:"email",onChange:function(e){return a({type:"handleChangeVisitorRecord",payload:e})},id:"email",placeholder:"Enter Visitor's email"})]}),Object(p.jsxs)(d.x,{children:[Object(p.jsx)(d.G,{htmlFor:"emiratesId",children:"Visitors Emirates ID"}),Object(p.jsx)(d.B,{disabled:t,value:c.emiratesId,name:"emiratesId",onChange:function(e){return a({type:"handleChangeVisitorRecord",payload:e})},id:"emiratesId",placeholder:"Enter Visitor's emirates id"})]})]})},b=c(732),O=["action","name","category","price","qty","total"],x=function(e){var t=e.receiptFormVisibility,c=e.showAddReceiptFormModal,a=e.receiptItems,i=e.dispatch,r=function(e){i({type:"setShowAddReceiptForm",payload:e})};return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsxs)(d.g,{children:[Object(p.jsxs)(d.k,{className:"d-flex justify-content-between align-items-center",children:[Object(p.jsx)("div",{children:Object(p.jsx)("strong",{children:"Shopping, Grooming and Others"})}),Object(p.jsx)(d.eb,{className:"mr-1",color:"dark",shape:"pill",variant:"opposite",value:t,onChange:function(e){return i({type:"setReceiptFormVisibility",payload:e.target.checked})}})]}),t&&Object(p.jsx)(d.h,{children:Object(p.jsx)(d.p,{fields:O,items:a||[],footer:!0,hover:!0,scopedSlots:{action:function(e){return Object(p.jsx)("td",{className:"px-1 py-2",children:Object(p.jsx)(d.f,{onClick:function(){return t={type:"removeItem",payload:e},console.log(t.payload),void i(t);var t},size:"sm",children:"\u2716"})})}},overTableSlot:Object(p.jsx)("div",{className:"text-right",children:Object(p.jsx)(d.f,{size:"sm",color:"primary",variant:"outline",className:"m-2 pl-3 pr-4",onClick:function(){return r(!0)},children:Object(p.jsx)("span",{className:"ml-1",children:"Add Item"})})})})})]}),Object(p.jsx)(b.a,{show:c,setShow:r,dispatch:i})]})},v=function(e){var t=e.doctorsReceipt;return Object(p.jsxs)("div",{children:[Object(p.jsx)("p",{className:"font-weight-bold font-lg",children:"Doctor receipt form"}),Object(p.jsxs)(d.T,{className:"my-2",children:[Object(p.jsx)(d.l,{md:"4",className:"font-weight-bold",children:"Pet's Name"}),Object(p.jsx)(d.l,{children:t.pet.label})]}),Object(p.jsxs)(d.T,{className:"my-2",children:[Object(p.jsx)(d.l,{md:"4",className:"font-weight-bold",children:"Check up Date"}),Object(p.jsx)(d.l,{children:t.appointmentDate.getDate()+"/"+(+t.appointmentDate.getMonth()+1)+"/"+t.appointmentDate.getFullYear()})]}),Object(p.jsxs)(d.T,{className:"my-2",children:[Object(p.jsx)(d.l,{md:"4",className:"font-weight-bold",children:"Doctor's Name"}),Object(p.jsx)(d.l,{children:t.assignedDoctor})]}),Object(p.jsxs)(d.T,{className:"my-2",children:[Object(p.jsx)(d.l,{md:"4",className:"font-weight-bold",children:"Is Follow Up ?"}),Object(p.jsx)(d.l,{children:t.isFollowUp?"Yes":"No"})]}),Object(p.jsxs)(d.T,{className:"my-2",children:[Object(p.jsx)(d.l,{md:"4",className:"font-weight-bold",children:"Doctor's Fee"}),Object(p.jsxs)(d.l,{children:[t.fee," AED"]})]})]})},f=c(194),g=c(719),y=c(196),I=c(195),w=function(e){var t=e.show,c=e.setShow,i=e.visitorId,r=e.setItems,n=e.setSelectedPet,o=l.a.useContext(f.a).addToast,u=Object(m.a)({method:"GET"},{manual:!0}),j=Object(s.a)(u,2)[1],h=l.a.useState({id:"",name:"",breed:"",age:"",dob:"",color:"",specie:"",gender:"",microchip:!1,microchipNumber:null}),b=Object(s.a)(h,2),O=b[0],x=b[1],v=function(e){var t=O.age;if("dob"===e.target.name){var c=(new Date).getFullYear(),i=new Date(e.target.value).getFullYear();t=c-i}x((function(c){return Object(a.a)(Object(a.a)({},c),{},Object(I.a)({age:t},e.target.name,e.target.value))}))};return Object(p.jsxs)(d.K,{show:t,onClose:function(){return c(!1)},children:[Object(p.jsx)(d.N,{children:"Add New Pet"}),Object(p.jsx)(d.L,{children:Object(p.jsxs)(d.T,{children:[Object(p.jsxs)(d.l,{md:"6",sm:"12",children:[Object(p.jsxs)(d.x,{children:[Object(p.jsx)(d.G,{htmlFor:"name",children:"Pet Name"}),Object(p.jsx)(d.B,{value:O.name,name:"name",onChange:v,id:"name",placeholder:"Enter name"})]}),Object(p.jsxs)(d.x,{children:[Object(p.jsx)(d.G,{htmlFor:"type",children:"Breed"}),Object(p.jsx)(d.B,{value:O.breed,name:"breed",onChange:v,id:"type",placeholder:"Enter breed"})]}),Object(p.jsxs)(d.x,{children:[Object(p.jsx)(d.G,{htmlFor:"age",children:"Pet Age ( years )"}),Object(p.jsx)(d.B,{value:O.age,name:"age",onChange:v,id:"age",placeholder:"Enter age"})]}),Object(p.jsxs)(d.x,{children:[Object(p.jsx)(d.G,{htmlFor:"age",children:"Pet DOB"}),Object(p.jsx)(d.B,{value:O.dob,name:"dob",type:"date",onChange:v,id:"dob",placeholder:"Enter dob"})]})]}),Object(p.jsxs)(d.l,{md:"6",sm:"12",children:[Object(p.jsxs)(d.x,{children:[Object(p.jsx)(d.G,{htmlFor:"color",children:"Pet Color"}),Object(p.jsx)(d.B,{value:O.color,name:"color",onChange:v,id:"color",placeholder:"Enter color"})]}),Object(p.jsxs)(d.x,{children:[Object(p.jsx)(d.G,{htmlFor:"specie",children:"Specie"}),Object(p.jsx)(d.B,{value:O.specie,name:"specie",onChange:v,id:"specie",placeholder:"Enter specie"})]}),Object(p.jsxs)(d.x,{children:[Object(p.jsx)(d.G,{htmlFor:"gender",children:"Sex"}),Object(p.jsxs)(d.U,{custom:!0,name:"gender",id:"text-pet-type",value:O.gender,onChange:v,children:[Object(p.jsx)("option",{value:"Male",children:"Male"}),Object(p.jsx)("option",{value:"Female",children:"Female"}),Object(p.jsx)("option",{value:"Neutered",children:"Neutered"}),Object(p.jsx)("option",{value:"Spayed",children:"Spayed"})]})]}),Object(p.jsxs)(d.x,{row:!0,className:"align-items-center mt-4",children:[Object(p.jsx)(d.l,{xs:"3",md:"3",children:Object(p.jsx)(d.eb,{color:"primary",name:"microchip",value:O.microchip,onChange:function(e){return t=e.target.checked,void x((function(e){return Object(a.a)(Object(a.a)({},e),{},{microchip:t,microchipNumber:null})}));var t},variant:"opposite",shape:"pill"})}),Object(p.jsx)(d.l,{xs:"6",md:"6",children:Object(p.jsx)(d.G,{htmlFor:"text-microchip",className:"pl-1",children:"Microchip ?"})})]}),O.microchip&&Object(p.jsxs)(d.x,{children:[Object(p.jsx)(d.G,{htmlFor:"microchipNumber",children:"Micro chip Number"}),Object(p.jsx)(d.B,{value:O.microchipNumber,name:"microchipNumber",onChange:v,id:"microchipNumber",placeholder:"Enter Microchip Number"})]})]})]})}),Object(p.jsxs)(d.M,{children:[Object(p.jsx)(d.f,{onClick:function(){return c(!1)},color:"danger",children:"Cancel"}),Object(p.jsx)(d.f,{onClick:function(){var e=Object(a.a)(Object(a.a)({},O),{},{patientId:i});delete e.id,j({url:g.a+"/pets",method:"POST",data:e}).then((function(e){x((function(t){return Object(a.a)(Object(a.a)({},t),{},{id:e.data.id})})),r((function(t){return[].concat(Object(y.a)(t),[e.data])})),n({label:e.data.name,value:e.data}),c(!1)})).catch((function(e){o({message:e.response.data.message})}))},color:"primary",children:"Submit"})]})]})},F=function(e){var t=e.visitorId,c=e.dispatch,a=l.a.useContext(f.a).addToast,i=Object(m.a)({method:"GET"},{manual:!0}),r=Object(s.a)(i,2)[1],n=l.a.useState(!1),o=Object(s.a)(n,2),u=o[0],h=o[1],b=l.a.useState(!1),O=Object(s.a)(b,2),x=O[0],v=O[1],y=l.a.useState(""),I=Object(s.a)(y,2),F=I[0],k=I[1],C=l.a.useState(""),N=Object(s.a)(C,2),V=(N[0],N[1]),R=l.a.useState([]),S=Object(s.a)(R,2),D=S[0],A=S[1],E=l.a.useState([]),T=Object(s.a)(E,2),G=T[0],P=T[1],q=l.a.useState(null),B=Object(s.a)(q,2),U=B[0],M=B[1],K=l.a.useState(null),Y=Object(s.a)(K,2),z=Y[0],L=Y[1],Q=l.a.useState(""),J=Object(s.a)(Q,2),H=J[0],W=J[1],X=l.a.useState(!1),Z=Object(s.a)(X,2),$=Z[0],_=Z[1];return l.a.useEffect((function(){F.length>0&&r({url:g.a+"/pets",method:"GET",params:{patientId:t,search:F}}).catch((function(e){a({message:e.response.data.message})}))}),[F,r,t]),l.a.useEffect((function(){}),[r,t]),l.a.useEffect((function(){r({url:g.a+"/users?role=3",method:"GET"}).then((function(e){var c;P((null===e||void 0===e||null===(c=e.data)||void 0===c?void 0:c.rows.map((function(e){return{label:e.name,value:e}})))||[]),r({url:g.a+"/pets/all/patients",method:"POST",data:{patientId:t}}).then((function(e){var t;A((null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.rows.map((function(e){return{label:e.name,value:e}})))||[])})).catch((function(e){var t,c;a({message:(null===(t=e.response)||void 0===t||null===(c=t.data)||void 0===c?void 0:c.message)||"Error occured try again later !"})}))})).catch((function(e){var t,c;a({message:(null===(t=e.response)||void 0===t||null===(c=t.data)||void 0===c?void 0:c.message)||"Error occured try again later !"})}))}),[]),Object(p.jsxs)("div",{children:[Object(p.jsx)("p",{onClick:function(){return h(!0)},className:"my-5 text-center",children:"Add Doctors check up"}),Object(p.jsxs)(d.K,{show:u,onClose:function(){return h(!1)},children:[Object(p.jsx)(d.N,{children:"Create check up"}),Object(p.jsxs)(d.L,{children:[Object(p.jsxs)(d.x,{row:!0,children:[Object(p.jsx)(d.l,{xs:"12",children:Object(p.jsx)(d.G,{className:"pt-1",htmlFor:"search",children:"Assign Doctor"})}),Object(p.jsx)(d.l,{xs:"12",children:Object(p.jsx)(j.a,{name:"search",value:z,options:G,onInputChange:function(e){return V(e)},onChange:function(e){L(e)}})})]}),Object(p.jsxs)(d.x,{row:!0,children:[Object(p.jsx)(d.l,{xs:"12",children:Object(p.jsx)(d.G,{className:"pt-1",htmlFor:"search",children:"Select Pet"})}),Object(p.jsx)(d.l,{xs:"12",children:Object(p.jsx)(j.a,{name:"search",value:U,options:D,onInputChange:function(e){return k(e)},onChange:function(e){M(e)}})})]}),Object(p.jsx)("div",{className:"text-right",children:Object(p.jsx)(d.f,{onClick:function(){return v(!0)},size:"sm",children:"Add New Pet"})}),Object(p.jsxs)(d.x,{children:[Object(p.jsx)(d.G,{htmlFor:"fee",children:"Fee"}),Object(p.jsx)(d.B,{value:H,onChange:function(e){return W(e.target.value)},name:"fee",id:"fee",placeholder:"Enter fees"})]}),Object(p.jsxs)(d.x,{row:!0,className:"align-items-center pt-3",children:[Object(p.jsx)(d.l,{xs:"3",md:"3",children:Object(p.jsx)(d.G,{htmlFor:"text-description",className:"pl-1",children:"Follow Up ?"})}),Object(p.jsx)(d.l,{xs:"9",md:"9",children:Object(p.jsx)(d.eb,{color:"primary",name:"active",value:$,onChange:function(e){return _(e.target.checked)},variant:"opposite",shape:"pill"})})]}),Object(p.jsx)(w,{show:x,visitorId:t,setShow:v,setItems:A,setSelectedPet:M})]}),Object(p.jsxs)(d.M,{children:[Object(p.jsx)(d.f,{color:"danger",onClick:function(){return h(!1)},children:"Cancel"}),Object(p.jsx)(d.f,{color:"primary",onClick:function(){var e,t;$||0!==+H?c({type:"addDoctorReceipt",payload:{pet:U,fee:0===+H?"0":H,appointmentDate:new Date,assignTo:null===z||void 0===z||null===(e=z.value)||void 0===e?void 0:e.id,assignedDoctor:null===z||void 0===z||null===(t=z.value)||void 0===t?void 0:t.name,isFollowUp:$}}):a({message:"Please provide fee or check follow up if it is follow up !"})},children:"Submit"})]})]})]})},k=function(e){var t=e.visitorId,c=e.doctorFormVisibility,a=e.isDoctorVisitAdded,i=e.doctorsReceipt,r=e.dispatch;return Object(p.jsx)(p.Fragment,{children:Object(p.jsxs)(d.g,{children:[Object(p.jsxs)(d.k,{className:"d-flex justify-content-between align-items-center",children:[Object(p.jsx)("div",{children:Object(p.jsx)("strong",{children:"Doctor's Visit"})}),Object(p.jsx)(d.eb,{className:"mr-1",color:"dark",shape:"pill",variant:"opposite",value:c,onChange:function(e){return r({type:"setDoctorFormVisibility",payload:e.target.checked})}})]}),c&&Object(p.jsx)(d.h,{children:a?Object(p.jsx)(v,{doctorsReceipt:i}):Object(p.jsx)(F,{visitorId:t,dispatch:r})})]})})},C=function(e,t){var c,i=t.type,r=t.payload;switch(i){case"setKeyword":return Object(a.a)(Object(a.a)({},e),{},{keyword:r});case"setItems":return Object(a.a)(Object(a.a)({},e),{},{items:r});case"setIsVisitorRecordAdded":return Object(a.a)(Object(a.a)({},e),{},{isVisitorRecordAdded:r});case"setVisitorsId":return Object(a.a)(Object(a.a)({},e),{},{visitorsId:r});case"setVisitorsRecord":return Object(a.a)(Object(a.a)({},e),{},{visitorRecord:Object(a.a)({},r)});case"handleChangeVisitorRecord":return Object(a.a)(Object(a.a)({},e),{},{visitorRecord:Object(a.a)(Object(a.a)({},e.visitorRecord),{},Object(I.a)({},r.target.name,r.target.value))});case"setReceiptFormVisibility":return Object(a.a)(Object(a.a)({},e),{},{receiptFormVisibility:r});case"setShowAddReceiptForm":return Object(a.a)(Object(a.a)({},e),{},{showAddReceiptForm:r});case"setDoctorFormVisibility":return Object(a.a)(Object(a.a)({},e),{},{doctorFormVisibility:r});case"setIsDoctorVisitAdded":return Object(a.a)(Object(a.a)({},e),{},{isDoctorVisitAdded:r});case"addItemInReceipt":var n=!0,s=-1;if((null===(c=r.packageId)||void 0===c?void 0:c.value)&&(n=!1),-1===(s=n?e.receiptItems.findIndex((function(e){var t;return e.id===(null===(t=r.itemId)||void 0===t?void 0:t.value)})):e.receiptItems.findIndex((function(e){var t;return e.packageId===(null===(t=r.packageId)||void 0===t?void 0:t.value)})))){var o,l,d,u,j,m,p,h,b={id:(null===(o=r.itemId)||void 0===o?void 0:o.value)||null,packageId:(null===(l=r.packageId)||void 0===l?void 0:l.value)||null,name:(null===(d=r.itemId)||void 0===d?void 0:d.label)||(null===(u=r.packageId)||void 0===u?void 0:u.label),category:r.categoryId.label,price:(null===(j=r.itemId)||void 0===j?void 0:j.price)||(null===(m=r.packageId)||void 0===m?void 0:m.price),qty:r.quantity,discount:r.discount||0,total:r.quantity*((null===(p=r.itemId)||void 0===p?void 0:p.price)||(null===(h=r.packageId)||void 0===h?void 0:h.price))};return Object(a.a)(Object(a.a)({},e),{},{receiptItems:[].concat(Object(y.a)(e.receiptItems),[b])})}return Object(a.a)(Object(a.a)({},e),{},{receiptItems:e.receiptItems.map((function(e,t){if(t===s){var c=+e.qty+ +r.quantity;return Object(a.a)(Object(a.a)({},e),{},{qty:c,total:c*e.price})}return e}))});case"removeItem":return Object(a.a)(Object(a.a)({},e),{},{receiptItems:e.receiptItems.filter((function(e){return r.id?e.id!==r.id:e.packageId!==r.packageId}))});case"addDoctorReceipt":var O={pet:r.pet,fee:r.fee,appointmentDate:r.appointmentDate,isFollowUp:r.isFollowUp,assignTo:r.assignTo,assignedDoctor:r.assignedDoctor};return Object(a.a)(Object(a.a)({},e),{},{isDoctorVisitAdded:!0,doctorsReceipt:O});case"resetForm":return Object(a.a)(Object(a.a)({},e),{},{keyword:"",items:[],isVisitorRecordAdded:!1,visitorsId:null,visitorRecord:{emiratesId:"",name:"",email:"",contact:""},receiptFormVisibility:!1,showAddReceiptForm:!1,doctorFormVisibility:!1,isDoctorVisitAdded:!1,receiptItems:[],doctorsReceipt:{pet:null,fee:"",appointmentDate:null,isFollowUp:!1}});default:return e}},N={keyword:"",items:[],isVisitorRecordAdded:!1,visitorsId:null,visitorRecord:{emiratesId:"",name:"",email:"",contact:""},receiptFormVisibility:!1,showAddReceiptForm:!1,doctorFormVisibility:!1,isDoctorVisitAdded:!1,receiptItems:[],doctorsReceipt:{pet:null,fee:"",appointmentDate:null,isFollowUp:!1}};t.default=function(){var e=Object(u.g)(),t=Object(o.useContext)(f.a).addToast,c=l.a.useReducer(C,N),i=Object(s.a)(c,2),b=i[0],O=i[1],v=Object(m.a)({method:"GET"},{manual:!0}),y=Object(s.a)(v,2)[1],I=function(){var e=Object(n.a)(r.a.mark((function e(){var c,a,i,n=arguments;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=n.length>0&&void 0!==n[0]?n[0]:null,a=n.length>1&&void 0!==n[1]?n[1]:null,e.prev=2,c&&c.preventDefault(),i=a||b.visitorsId,e.next=7,y({url:g.a+"/patients/"+i+"/visit",method:"POST"});case 7:e.next=13;break;case 9:e.prev=9,e.t0=e.catch(2),console.log(e.t0),t({message:"Couldn't store users visit."});case 13:return e.prev=13,e.abrupt("return",Promise.resolve("Visits"));case 16:case"end":return e.stop()}}),e,null,[[2,9,13,16]])})));return function(){return e.apply(this,arguments)}}();l.a.useEffect((function(){b.keyword.length>0&&y({url:g.a+"/patients",params:{search:b.keyword}}).then((function(e){var t;O({type:"setItems",payload:((null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.rows)||[]).map((function(e,t){return{label:t+1+": "+e.name+" - "+e.contact,value:e}}))})}))}),[b.keyword,y]);var w=Object(p.jsx)("div",{className:"d-flex justify-content-end",children:Object(p.jsx)(d.f,{onClick:function(e){return I(e)},color:"primary",children:"Add A Visit"})});return Object(p.jsx)(p.Fragment,{children:Object(p.jsx)(d.T,{children:Object(p.jsx)(d.l,{xs:"12",sm:"12",children:Object(p.jsxs)(d.g,{children:[Object(p.jsxs)(d.k,{children:["Visitor",Object(p.jsx)("small",{children:" Form"})]}),Object(p.jsxs)(d.h,{children:[Object(p.jsxs)(d.x,{row:!0,children:[Object(p.jsx)(d.l,{xs:"12",children:Object(p.jsx)(d.G,{className:"pt-1",htmlFor:"search",children:"Search"})}),Object(p.jsx)(d.l,{xs:"12",children:Object(p.jsx)(j.a,{name:"search",options:b.items,onInputChange:function(e){return O({type:"setKeyword",payload:e})},onChange:function(e){var t=e.value;O({type:"setVisitorsRecord",payload:{emiratesId:t.emiratesId,name:t.name,email:t.email,contact:t.contact}}),O({type:"setVisitorsId",payload:t.id}),O({type:"setIsVisitorRecordAdded",payload:!0}),O({type:"setKeyword",payload:{}})}})})]}),Object(p.jsx)(d.g,{children:Object(p.jsxs)(d.h,{children:[Object(p.jsx)(h,{isVisitorRecordAdded:b.isVisitorRecordAdded,visitorRecord:b.visitorRecord,dispatch:O}),b.isVisitorRecordAdded&&w]})}),b.isVisitorRecordAdded&&Object(p.jsxs)(d.T,{children:[Object(p.jsx)(d.l,{sm:"6",children:Object(p.jsx)(x,{receiptFormVisibility:b.receiptFormVisibility,showAddReceiptFormModal:b.showAddReceiptForm,receiptItems:b.receiptItems,dispatch:O})}),Object(p.jsx)(d.l,{sm:"6",children:Object(p.jsx)(k,{visitorId:b.visitorsId,doctorFormVisibility:b.doctorFormVisibility,isDoctorVisitAdded:b.isDoctorVisitAdded,doctorsReceipt:b.doctorsReceipt,dispatch:O})})]})]}),Object(p.jsx)(d.i,{children:Object(p.jsx)("div",{className:"d-flex",children:Object(p.jsxs)("div",{className:"w-50 ml-auto text-right",children:[Object(p.jsx)(d.f,{onClick:function(){O({type:"setVisitorsRecord",payload:{emiratesId:"",name:"",email:"",contact:""}}),O({type:"setVisitorsId",payload:null}),O({type:"setIsVisitorRecordAdded",payload:!1})},className:"w-25 mr-1",color:"danger",children:"Clear"}),Object(p.jsx)(d.f,{onClick:function(){b.isVisitorRecordAdded?function(){var t={patientId:b.visitorsId,appointment:b.isDoctorVisitAdded,checkUpPrice:+b.doctorsReceipt.fee,description:"Order Receipt For Shopping.",followUp:b.doctorsReceipt.isFollowUp,assignTo:b.doctorsReceipt.assignTo||null,items:b.receiptItems.filter((function(e){return null!==e.id})).map((function(e){return{itemId:e.id,quantity:e.qty,discount:e.discount||0}})),packages:b.receiptItems.filter((function(e){return null!==e.packageId})).map((function(e){return{packageId:e.packageId,quantity:e.qty,discount:e.discount||0}}))};y({url:g.a+"/orders",method:"POST",data:t}).then((function(t){O({type:"resetForm",payload:null}),e.push("/visitors")}))}():y({url:g.a+"/patients",method:"POST",data:Object(a.a)({},b.visitorRecord)}).then(function(){var e=Object(n.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I(null,t.data.id);case 2:O({type:"setVisitorsId",payload:t.data.id}),O({type:"setIsVisitorRecordAdded",payload:!0});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){t({message:e.response.data.message})}))},className:"w-25",color:"primary",children:"Submit"})]})})})]})})})})}}}]);
//# sourceMappingURL=19.2751b099.chunk.js.map