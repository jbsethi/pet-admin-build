{"version":3,"sources":["views/users/AddUser.js"],"names":["AddUser","match","addToast","useContext","AppContext","history","useHistory","useAxios","url","PUBLIC_API","params","id","method","manual","data","loading","executePost","userData","getUserDetails","React","useState","previewImg","setPreviewImg","emiratesId","role","name","email","contact","username","password","confirm_password","image","active","userRecord","setUserRecord","handleChange","e","oldState","target","checked","value","useEffect","push","catch","err","message","response","xl","action","className","lg","row","sm","col","htmlFor","onChange","placeholder","custom","type","color","variant","shape","src","alt","width","reader","FileReader","file","files","onloadend","result","readAsDataURL","onClick","storeInfo","formData","obj","FormData","Object","keys","forEach","key","append","formDataObj"],"mappings":"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","file":"static/js/24.3ce63421.chunk.js","sourcesContent":["import React, { useContext } from 'react'\nimport { useHistory } from 'react-router-dom'\nimport useAxios from 'axios-hooks'\n\nimport { PUBLIC_API } from '../../config/index'\n\nimport {\n  CCard,\n  CCardBody,\n  CCardHeader,\n  CCol,\n  CRow,\n  CForm,\n  CFormGroup,\n  CLabel,\n  CInput,\n  CSelect,\n  CSwitch,\n  CMedia,\n  CMediaBody,\n  CCardFooter,\n  CButton\n} from '@coreui/react'\n\nimport { AppContext } from '../../App.js'\n\nconst defaultImageUrl = \"https://www.kindpng.com/picc/m/72-723761_student-png-sammilani-mahavidyalaya-undergraduate-and-dummy-user.png\"\n\nconst formDataObj = (obj) => {\n  const formData = new FormData()\n  Object.keys(obj).forEach(key => formData.append(key, obj[key]))\n  return formData\n}\n\nconst AddUser = ({ match }) => {\n  const { addToast } = useContext(AppContext)\n  const history = useHistory()\n\n  const [\n    { data, loading },\n    executePost\n  ] = useAxios(\n    {\n      url: PUBLIC_API + `/users${match?.params?.id ? '/' + match?.params?.id : ''}`,\n      method: match?.params?.id ? 'PUT' : 'POST'\n    },\n    { manual: true }\n  )\n\n  const [\n    { data: userData },\n    getUserDetails\n  ] = useAxios({\n    url: `${PUBLIC_API}/users/${match.params.id}`,\n    method: 'GET'\n  },\n  {\n    manual: true\n  })\n\n\n  \n  const [previewImg, setPreviewImg] = React.useState(null)\n  const [userRecord, setUserRecord] = React.useState({\n    emiratesId: '',\n    role: 1,\n    name: '',\n    email: '',\n    contact: '',\n    username: '',\n    password: '',\n    confirm_password: '',\n    image: '',\n    active: true\n  })\n\n  const handleChange = (e) => {\n    setUserRecord(oldState => {\n      return {\n        ...oldState,\n        [e.target.name]: e.target.name === 'active'? e.target.checked : e.target.value\n      }\n    })\n  }\n\n  const handleImageChange = (e) => {\n    let reader = new FileReader()\n    let file = e.target.files[0]\n\n    reader.onloadend = () => {\n      setUserRecord(oldState => {\n        return {\n          ...oldState,\n          image: file\n        }\n      })\n\n      setPreviewImg(reader.result)\n    }\n\n    reader.readAsDataURL(file)\n  }\n\n  const storeUserInfo = () => {\n    if (!loading) {\n      const storeInfo = {...userRecord}\n      if (match.params.id) {\n        delete storeInfo.password\n        delete storeInfo.confirm_password\n      }\n      const formData = formDataObj(storeInfo)\n      \n      executePost({\n        data: formData\n      }).catch(err => {\n        addToast({\n          message: err.response.data.message\n        })\n      })\n    }\n  }\n\n  const resetForm = () => {\n    setUserRecord(() => {\n      return {\n        emiratesId: '',\n        role: 1,\n        name: '',\n        email: '',\n        contact: '',\n        username: '',\n        password: '',\n        confirm_password: '',\n        image: '',\n        active: true\n      }\n    })\n\n    setPreviewImg(null)\n  }\n\n\n  React.useEffect(() => {\n    if (data) {\n      history.push('/users')\n    }\n  }, [data, history])\n\n  React.useEffect(() => {\n    if (userData) {\n      setUserRecord({\n        emiratesId: userData.emiratesId,\n        role: userData.role,\n        name: userData.name,\n        email: userData.email,\n        contact: userData.contact,\n        username: userData.username,\n        password: '',\n        confirm_password: '',\n        image: userData.image,\n        active: userData.active,\n      })\n    } else {\n      if (match?.params?.id) {\n        getUserDetails().catch(err => {\n          addToast({\n            message: err.response.data.message\n          })\n        })\n      }\n    }\n  }, [userData, setUserRecord, getUserDetails, match])\n\n  return (\n    <CRow>\n      <CCol xl={12}>\n        <CCard>\n          <CCardHeader>\n            Add Users\n          </CCardHeader>\n          <CCardBody>\n            <CForm action=\"\" method=\"post\" className=\"form-horizontal\">\n              <CRow>\n                <CCol lg=\"7\">\n                  <CFormGroup row className=\"justify-content-center\">\n                    <CLabel className=\"text-right\" sm=\"3\" col htmlFor=\"input-emirates-id\">Emirates ID</CLabel>\n                    <CCol sm=\"6\">\n                      <CInput value={userRecord.emiratesId} onChange={handleChange} id=\"input-emirates-id\" name=\"emiratesId\" placeholder=\"Emirates ID\" />\n                    </CCol>\n                  </CFormGroup>\n                  <CFormGroup row className=\"justify-content-center\">\n                    <CLabel className=\"text-right\" sm=\"3\" col htmlFor=\"input-role\">Roles</CLabel>\n                    <CCol sm=\"6\">\n                      <CSelect value={userRecord.role} onChange={handleChange} custom name=\"role\" id=\"input-role\">\n                        <option value=\"2\">Administrator</option>\n                        <option value=\"4\">Receiptionist</option>\n                        <option value=\"3\">Doctor</option>\n                      </CSelect>\n                    </CCol>\n                  </CFormGroup>\n                  <CFormGroup row className=\"justify-content-center\">\n                    <CLabel className=\"text-right\" sm=\"3\" col htmlFor=\"input-name\">Name</CLabel>\n                    <CCol sm=\"6\">\n                      <CInput value={userRecord.name} onChange={handleChange} id=\"input-name\" name=\"name\" placeholder=\"Name\" />\n                    </CCol>\n                  </CFormGroup>\n                  <CFormGroup row className=\"justify-content-center\">\n                    <CLabel className=\"text-right\" sm=\"3\" col htmlFor=\"input-email\">Email</CLabel>\n                    <CCol sm=\"6\">\n                      <CInput value={userRecord.email} onChange={handleChange} id=\"input-email\" name=\"email\" placeholder=\"Email\" />\n                    </CCol>\n                  </CFormGroup>\n                  <CFormGroup row className=\"justify-content-center\">\n                    <CLabel className=\"text-right\" sm=\"3\" col htmlFor=\"input-contact\">Phone No</CLabel>\n                    <CCol sm=\"6\">\n                      <CInput value={userRecord.contact} onChange={handleChange} id=\"input-contact\" name=\"contact\" placeholder=\"Phone no\" />\n                    </CCol>\n                  </CFormGroup>\n                  <CFormGroup row className=\"justify-content-center\">\n                    <CLabel className=\"text-right\" sm=\"3\" col htmlFor=\"input-username\">Username</CLabel>\n                    <CCol sm=\"6\">\n                      <CInput value={userRecord.username} onChange={handleChange} id=\"input-username\" name=\"username\" placeholder=\"Username\" />\n                    </CCol>\n                  </CFormGroup>\n                  {\n                    !match?.params?.id &&\n                    <>\n                      <CFormGroup row className=\"justify-content-center\">\n                        <CLabel className=\"text-right\" sm=\"3\" col htmlFor=\"input-password\">Password</CLabel>\n                        <CCol sm=\"6\">\n                          <CInput value={userRecord.password} onChange={handleChange} id=\"input-password\" name=\"password\" placeholder=\"Password\" type=\"password\" />\n                        </CCol>\n                      </CFormGroup>\n                      <CFormGroup row className=\"justify-content-center\">\n                        <CLabel className=\"text-right\" sm=\"3\" col htmlFor=\"input-confirm-password\">Confirm Password</CLabel>\n                        <CCol sm=\"6\">\n                          <CInput value={userRecord.confirm_password} onChange={handleChange} id=\"input-confirm-password\" name=\"confirm_password\" placeholder=\"Password\" type=\"password\" />\n                        </CCol>\n                      </CFormGroup>\n                    </> \n                  }\n                  <CFormGroup row className=\"justify-content-center\">\n                    <CLabel className=\"text-right\" sm=\"3\" col htmlFor=\"input-active\">Active</CLabel>\n                    <CCol sm=\"6\">\n                      <CSwitch\n                        className=\"pt-1\"\n                        color=\"primary\"\n                        name=\"active\"\n                        checked={userRecord.active}\n                        onChange={handleChange}\n                        {\n                          ...({\n                            variant: 'opposite',\n                            shape:'pill'\n                          })\n                        }\n                      />\n                    </CCol>\n                  </CFormGroup>\n                </CCol>\n                <CCol lg=\"4\">\n                  <CMedia className=\"flex-column\">\n                    <img src={previewImg || defaultImageUrl} alt=\"preview\" width=\"100%\"/>\n                    <CMediaBody className=\"w-100 mt-4\">\n                      <CFormGroup row>\n                        <CCol sm=\"12\">\n                          <CInput onChange={handleImageChange} id=\"input-image\" name=\"image\" type=\"file\" />\n                        </CCol>\n                      </CFormGroup>\n\n                    </CMediaBody>\n                  </CMedia>\n                </CCol>\n              </CRow>\n            </CForm>\n          </CCardBody>\n          <CCardFooter>\n            <section className=\"text-right w-50 ml-auto\">\n              <CButton onClick={resetForm} color=\"danger\" className=\"mr-1 w-25\">\n                Clear\n              </CButton>\n              <CButton onClick={storeUserInfo} color=\"primary\" className=\"w-25\">\n                {loading ? 'Loading' : 'Submit'}\n              </CButton>\n            </section>\n          </CCardFooter>\n        </CCard>\n      </CCol>\n    </CRow>\n  )\n}\n\nexport default AddUser\n"],"sourceRoot":""}